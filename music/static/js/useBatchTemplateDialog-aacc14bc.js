import{u as C}from"./music-4f2fdac3.js";import{n as w,p as y,Y as d,e,ar as x,r as o,aO as F,aP as S,ax as T,h as A,aQ as B,aR as O,aS as D,aT as N,at as P}from"./index-b9fe2a94.js";import{h as V}from"./song-361d1acd.js";import"./mitt-7f99bbc0.js";function k(l){const s=l,t=w(0),i=w(0);let n=null;const g={block:"start",inline:"center",behavior:"smooth"},c=y(()=>t.value>0),u=y(()=>t.value<i.value-1);function v(){n=document.querySelector(s),n&&c.value&&(t.value-=1,f(t.value))}function b(){n=document.querySelector(s),n&&u.value&&(t.value+=1,f(t.value))}function f(h){n.children[h].scrollIntoView(g)}function m(){t.value=0}return{childrenLength:i,enablePrev:c,enableNext:u,prevTo:v,nextTo:b,resetCurIndex:m}}var r=(l=>(l[l.Start=0]="Start",l[l.BasicAnalysis=1]="BasicAnalysis",l[l.OSS=2]="OSS",l[l.DetailAnalysis=3]="DetailAnalysis",l))(r||{});const p={0:"上传完成，解析开始",1:"基础信息解析完成",2:"OSS上传完成",3:"详细信息解析完成"};function W(l){const s=d({newSongs:new Array,formColumns:C().songTemplateCreateFormColumns,albumFormColumns:C().albumDetailFormColumns,singerFormColumns:C().singerFormColumns,isWaiting:!1}),t=d({songLists:new Array,isAlive:!1});function i(){s.newSongs=[],s.isWaiting=!1}function n(){t.songLists=[],t.isAlive=!1}const{childrenLength:g,enablePrev:c,enableNext:u,prevTo:v,nextTo:b,resetCurIndex:f}=k(".outer_form"),m=d({title:"批量新增歌曲信息",openDelay:100,closeOnClickModal:!1,closeOnPressEscape:!1,contentRenderer:()=>e("div",null,[e("div",{class:"outer_form flex overflow-x-scroll"},[s.newSongs.map(a=>e(x,{class:"grow-0 shrink-0 basis-full",formValue:a,formColumns:s.formColumns,showButton:!1,isFlex:!1},{embedAlbum:()=>e(x,{class:"embed_album w-full",formValue:a.album,formColumns:s.albumFormColumns,showButton:!1,isFlex:!1},null),embedSinger:()=>e(x,{class:"embed_singer w-full",formValue:a.singer,formColumns:s.singerFormColumns,showButton:!1,isFlex:!1},null)}))]),s.newSongs.length>1?e("div",{class:"flex justify-center items-center mt-2"},[e(o("el-button"),{icon:F,circle:!0,disabled:!c.value,onClick:v},null),e(o("el-button"),{icon:S,circle:!0,disabled:!u.value,onClick:b},null)]):e("div",null,null)]),beforeSure:async a=>{await V(s.newSongs),T("批量新增成功",{type:"success"}),a(),l&&l()},closeCallBack:()=>{i(),n(),f()}}),h=d({title:"歌曲上传进度",closeOnClickModal:!1,closeOnPressEscape:!1,contentRenderer:()=>e("ul",null,[t.songLists.map((a,_)=>e("li",{key:a.originalName+_,class:"flex items-center"},[e(o("el-tooltip"),{placement:"left",effect:"light",enterable:!1},{default:()=>e("div",{class:"w-48 truncate text-base font-semibold"},[a.originalName,A("：")]),content:()=>e("div",{class:"text-base font-semibold"},[a.originalName])}),e(o("el-steps"),{class:"flex-1",active:a.status,"process-status":"finish","finish-status":"success","align-center":!0},{default:()=>[e(o("el-step"),{title:r[0],description:p[0],icon:B},null),e(o("el-step"),{title:r[1],description:p[1],icon:O},null),e(o("el-step"),{title:r[2],description:p[2],icon:D},null),e(o("el-step"),{title:r[3],description:p[3],icon:N},null)]})]))]),footerRenderer:()=>e("div",null,null),closeCallBack:()=>{s.isWaiting&&(n(),P(m))}});return{batchTemplates:s,songProgress:t,batchTemplateSongsDialog:m,progressDialog:h,childrenLength:g}}export{W as useBatchTemplateDialog};
